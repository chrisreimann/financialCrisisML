# Code: Machine Learning for Financial Crisis Prediction
This repository contains the code used in the paper "**[Predicting Financial Crises: An Evaluation of Machine Learning Algorithms and Model Explainability for Early Warning Systems](https://link.springer.com/article/10.1007/s43253-024-00114-4)**".

The paper addresses the critical challenge of detecting financial crises in their early stages given their profound economic and societal consequences. It investigates the efficacy of machine learning models by comparing the standard econometric model of Logistic Regression with k-nearest Neighbours, Random Forest, Extremely Randomised Trees, Support Vector Machine, and artificial Neural Network models in a cross-validation experiment. The study utilises financial crisis observations between 1870-2020 from the MacroHistory database and up to 15 early warning indicators from different theoretical backgrounds. The results demonstrate that advanced machine learning models, particularly Random Forest and Extremely Randomised Trees, outperform Logistic Regression, as measured by the area under the receiver operating characteristic curve (AUROC). This finding holds across various crisis data sources, early warning indicator sets, and model specifications. Furthermore, the paper emphasises the importance of model explainability for both researchers and policymakers by employing Accumulated Local Effect (ALE) plots to unravel the complex predictive processes of advanced machine learning models and provide deeper insight into the underlying crisis dynamics. Nonlinear connections to financial crises were identified for several early warning indicators, which are difficult to capture by linear models. Several U-shaped relationships were observed, highlighting the disruptive role of strong economic changes for financial stability.

## Structure of the Code
The experiments of the paper are implemented in the Python programming language. The machine learning models were adapted from the [Scikit-Learn](https://github.com/scikit-learn/scikit-learn) package, while the [Pandas](https://github.com/pandas-dev/pandas), [Numpy](https://github.com/numpy/numpy) and [MatplotLib](https://github.com/matplotlib/matplotlib) packages provided the basis for more general data processing. The ALE plots were generated using the  [Alibi Explain](https://github.com/SeldonIO/alibi) package. The code was organized into the following files:
- *altCrisisData.py*: Manages access to alternative data sources for crisis events, namely ESRB and Laeven & Valencia 2018.
- *doExperiment.py*: Runs the actual experiment based on the collected data and machine learning models from SciKitLearn and allows the selection of different experimental designs (Cross-Validation, Strict Forecasting, In-Sample Prediction).
- *prepareData.py*: Loads and processes the crisis event and early warning indicator data. 
- *utils.py*: Provides custom data splitting methods (train/test) used in the experiments. 
